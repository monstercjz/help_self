# 游戏数据工具 (Game Data) 插件

## 1. 功能简介

本插件旨在替代原有的多个独立Lua脚本，提供一个统一的、图形化的界面来处理特定的游戏数据工作流程。其核心功能分为三个步骤：

1.  **提取账号信息**: 根据分机和角色名的对应关系，从游戏数据库中查询并提取每个分机对应的所有角色账号信息，并生成独立的文本文件。
2.  **汇总角色配置**: 将分散在各个分机目录下的“角色配置”文件，根据分机与角色名的对应关系，聚合到一个统一的 `all` 目录中，便于批量修改。
3.  **分发角色配置**: 将 `all` 目录中已修改的“角色配置”文件，根据对应关系，准确地分发回各个分机对应的目录中。

## 2. 界面说明

插件界面主要由以下几个部分组成：

-   **根目录设置**:
    -   **操作根目录**: 指定所有文件操作的基础路径（例如 `D:\天龙相关\临时处理`）。所有分机ID对应的文件夹（如 `32401`, `41706`）都应位于此目录下。
    -   **浏览...**: 点击此按钮可以方便地通过图形界面选择操作根目录。

-   **数据库设置**:
    -   **数据库文件**: 指定包含角色账号信息的SQLite数据库文件（`.db` 文件）的完整路径。
    -   **浏览...**: 点击此按钮可以选择数据库文件。

-   **分机账号配置**:
    -   **从文件加载配置...**: 点击此按钮可以选择一个 `.txt` 文件，该文件定义了分机ID与角色名的对应关系。加载后，文件内容会显示在下方的文本框中。
    -   **文本框**: 显示当前加载的配置内容。格式为 `分机ID:角色名1|角色名2|...`，每行一条记录。

-   **核心操作**:
    -   **1. 提取账号信息**: 执行数据提取功能。
    -   **2. 汇总角色配置**: 执行文件汇总功能。
    -   **3. 分发角色配置**: 执行文件分发功能。

-   **操作日志**:
    -   显示插件执行各项操作时的详细步骤、成功信息、警告或错误。

## 3. 使用流程

一个典型的工作流程如下：

1.  **首次配置**:
    -   点击“根目录设置”旁的“浏览...”按钮，选择你的主工作目录。
    -   点击“数据库设置”旁的“浏览...”按钮，选择 `TL_game.db` 数据库文件。
    -   点击“从文件加载配置...”按钮，选择包含分机账号对应关系的 `.txt` 文件。
    -   完成以上步骤后，相关路径会自动保存，下次启动时无需重新配置。

2.  **提取最新的账号信息**:
    -   点击 **1. 提取账号信息** 按钮。
    -   插件会连接数据库，根据配置信息，在每个分机目录下创建 `游戏账号\{分机ID}.txt` 文件，其中包含了最新的账号列表。

3.  **汇总配置以进行修改**:
    -   点击 **2. 汇总角色配置** 按钮。
    -   插件会扫描每个分机目录下的 `角色配置` 文件夹，并将与该分机角色名匹配的文件/文件夹复制到根目录下的 `all` 文件夹中。

4.  **分发已修改的配置**:
    -   在 `all` 文件夹中对角色配置进行批量修改。
    -   修改完成后，点击 **3. 分发角色配置** 按钮。
    -   插件会将 `all` 文件夹中的每个文件/文件夹，根据文件名中包含的角色名，复制回其对应的分机 `角色配置` 目录中。

## 4. 配置文件说明 (`config.ini`)

本插件的所有持久化设置都保存在主程序的 `config.ini` 文件的 `[game_data]` 区段下。高级用户可以直接修改此文件。

-   `root_path`: 操作根目录的绝对路径。
-   `db_path`: 数据库文件的绝对路径。
-   `config_path`: 分机账号配置 `.txt` 文件的绝对路径。
-   `db_table_name`: (高级) 数据库中存储账号信息的表名。默认为 `账号数据`。
-   `db_member_col`: (高级) 上述表中存储角色名的列名。默认为 `角色名`。
-   `db_account_col`: (高级) 上述表中存储账号信息的列名。默认为 `账号`。

**注意**: 除非数据库结构发生变化，否则不建议修改 `db_` 开头的三个高级配置项。
